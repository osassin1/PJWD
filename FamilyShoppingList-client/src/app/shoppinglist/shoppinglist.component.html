<div class="container-sm bg-light">
    <app-navigation></app-navigation>
</div>

<div class="container-sm bg-light">
    <div class="row">
        <div class="col-md-7">

            <div class="py-1">
                <form [formGroup]="selectShoppingListForm">
                    <ng-select [items]="shoppingToSelectFrom" placeholder="Select Shopping List"
                        labelForId="shoppingToSelectFrom" formControlName="shopping_list_form" [tabIndex]=0
                        (change)="selectedShoppingList" (ngModelChange)="onSelectChange()">
                        <ng-template ng-label-tmp let-item="item">
                            <span class="label-text">{{item.shopping_date}}
                                {{item['shopping_list_to_inventory.inventory_to_store.name']}}</span>

                        </ng-template>
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            <span class="label-text">{{item.shopping_date}}
                                {{item['shopping_list_to_inventory.inventory_to_store.name']}}</span>

                        </ng-template>
                    </ng-select>
                </form>
            </div>
            <div ngbAccordion class="accordian-button category-accordion">
                @for (item of listCategories; track item) {
                <div ngbAccordionItem [collapsed]="item['list_category_id']"
                    [disabled]="!getCategoryNo(item['list_category_id'])">
                    <h2 ngbAccordionHeader>
                        <button ngbAccordionButton class="category-total-display d-flex">
                            <div class="p-1 flex-grow-1">{{ item['name'] }}</div>
                            <div class="p-2 padding:10px;" *ngIf="shoppingListAllTotal.size>0 && 
                                  shoppingListAllTotal.get(item.list_category_id)">
                                @for (inventoryItem of shoppingListAllTotal.get(item.list_category_id)?.family_members;
                                track inventoryItem){
                                <!-- <span class="d-inline-block rounded-circle p-2"  -->
                                <div class="d-inline-block family_member_dot p-2"
                                    [ngStyle]="{ 'background-color': inventoryItem.color_name, 'padding': '10em'  }">
                                </div>
                                
                                }
                            </div>
                            <div class="p-2" *ngIf="shoppingListAllTotal.size>0 && 
                         shoppingListAllTotal.get(item.list_category_id)">
                                #{{shoppingListAll.get(item.list_category_id)?.length}}
                            </div>
                        </button>
                    </h2>
                    <div ngbAccordionCollapse>
                        <div ngbAccordionBody>
                            <ng-template>
                                @for (inventoryItem of shoppingListAll.get(item.list_category_id);
                                track inventoryItem) {
                                    <div class="category-item-display d-flex">
                                        <div class="p-1"><img class="inventory-picture" [src]='getPicture(inventoryItem.inventory_id)'></div>
                                        
                                        <div class="p-1 flex-grow-1">{{inventoryItem.shopping_list_to_inventory.name}}
                                            <div class="d-inline-block family_member_dot p-1"
                                                [ngStyle]="{ 'background-color': inventoryItem. shopping_list_to_family_member.family_member_to_color.name}">
                                            </div>
                                            <div class="p-1 category-item-notes" category-item-notes>
                                                {{inventoryItem.shopping_list_to_inventory.notes}}
                                            </div>
                                        </div>
                                        <div class="p-1">
                                            {{adjustForDecimals(inventoryItem.quantity,inventoryItem.shopping_list_to_inventory.inventory_to_quantity.unit)}}
                                        </div>
                                        <div class="p-1">
                                            {{inventoryItem.shopping_list_to_inventory.inventory_to_quantity.symbol}}</div>
                                    </div>
                                }
                            </ng-template>
                        </div>
                    </div>
                </div>
                }
            </div>
        </div>
    </div>